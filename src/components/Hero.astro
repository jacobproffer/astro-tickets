---
import Container from "@components/Container.astro";
import Stat from "@components/Stat.astro";
import Graphic from "@images/graphic.svg";
import { getCollection } from "astro:content";

const initialYear = 2007;
const currentYear = new Date().getFullYear();
const years = currentYear - initialYear;

const tickets = await getCollection("tickets");
const ticketCount = tickets.length;

// Get unique theaters from tickets
const uniqueTheaters = new Set(tickets.map((ticket) => ticket.data.theater));
const theaterCount = uniqueTheaters.size;
---

<Container class="grid gap-4 text-black bg-card mb-4" as="section">
  <h1 class="sr-only">Deadman's Brew Movie Ticket Collection</h1>
  <Graphic mode="inline" />
  <ul class="grid grid-cols-3 border-t border-b border-black border-solid">
    <li
      class="flex items-center justify-between border-r border-black pt-4 pr-4 pb-4 border-solid"
    >
      <Stat label="Years" value={years} />
    </li>
    <li
      class="flex items-center justify-between p-4 border-r border-black border-solid"
    >
      <Stat label="Theaters" value={theaterCount} />
    </li>
    <li class="flex items-center justify-between pt-4 pb-4 pl-4">
      <Stat label="Tickets" value={ticketCount} />
    </li>
  </ul>
</Container>
