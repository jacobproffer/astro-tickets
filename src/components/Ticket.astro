---
import {
  formatDateForDisplay,
  formatDateForDateTime,
  formatPrice,
} from "../utils/format";

interface Props {
  title: string;
  theater: string;
  time: string;
  price: number;
  rating: string;
  international?: boolean;
  rerelease?: boolean;
}

const { title, theater, time, price, rating, international, rerelease } =
  Astro.props;

const getBackgroundColor = () => {
  if (international) return "bg-green";
  if (rerelease) return "bg-blue-100";
  return "bg-card";
};
---

<!-- Minimal Movie Ticket -->
<div class="relative h-full" transition:animate="slide">
  <div
    class={`h-full ${getBackgroundColor()} p-4 border-r border-b border-solid border-black`}
  >
    <!-- Theater Header -->
    {
      theater && (
        <div class="text-xs uppercase tracking-wide text-black font-mono flex items-center justify-between">
          <div>
            <span class="sr-only">Ticket purchased at</span>
            {theater}
          </div>
          {(international || rerelease) && (
            <span
              class="px-1 py-0.5 border border-solid border-black text-xs font-bold"
              aria-hidden="true"
            >
              {international ? "INTL" : "RE-RELEASE"}
            </span>
          )}
        </div>
      )
    }

    <!-- Movie Title -->
    {
      title && (
        <h3 class="text-2xl font-bold leading-tight -mx-2 px-2 py-1 mb-2">
          {title}
        </h3>
      )
    }

    <!-- Ticket Details -->
    <div class="space-y-4 text-sm">
      <!-- Date and Rating -->
      <div class="flex justify-between items-center">
        {
          time && (
            <div>
              <span class="text-xs uppercase tracking-wide block mb-1">
                Date
              </span>
              <time datetime={formatDateForDateTime(time)} class="font-medium">
                <span class="sr-only">Ticket purchased on</span>
                {formatDateForDisplay(time)}
              </time>
            </div>
          )
        }

        {
          rating && (
            <div class="text-right">
              <span class="text-xs uppercase tracking-wide block mb-1">
                Rated
              </span>
              <span class="px-2 py-1 border border-solid text-xs font-bold">
                <span class="sr-only">The movie is rated</span>
                {rating}
              </span>
            </div>
          )
        }
      </div>

      <!-- Price -->
      {
        price !== undefined && price !== null && (
          <div class="pt-3 border-t border-solid border-black">
            <div class="flex justify-between items-center">
              <span
                class="text-xs uppercase tracking-wide font-mono"
                aria-hidden="true"
              >
                Admit One
              </span>
              <span class="text-lg font-bold text-black">
                <span class="sr-only">The ticket cost</span>
                {formatPrice(price)}
              </span>
            </div>
          </div>
        )
      }
    </div>
  </div>
</div>
